{
  "name": "Heavy Talkers â€“ Edge & Worker Nodes",
  "description": "Top nodes by throughput (in/out events). Filter by Fleet for Edge nodes or by Worker group for Stream workers.",
  "created": 1769600000000,
  "modified": 1769600000000,
  "createdBy": "pack",
  "modifiedBy": "pack",
  "displayCreatedBy": "Cribl Search Inventory Pack",
  "displayModifiedBy": "Cribl Search Inventory Pack",
  "schedule": { "enabled": false, "cronSchedule": "0 * * * *", "tz": "UTC", "keepLastN": 2 },
  "groups": {},
  "elements": [
    {
      "id": "ht-time-range",
      "type": "input.timerange",
      "variant": "input",
      "title": "Time Range",
      "inputId": "time_range",
      "config": { "defaultValue": { "earliest": "-1h", "latest": "now", "timezone": "local" } },
      "layout": { "x": 0, "y": 0, "w": 3, "h": 2 }
    },
    {
      "id": "ht-fleet-dropdown",
      "type": "input.dropdown",
      "variant": "input",
      "title": "Fleet (Edge)",
      "inputId": "fleet",
      "config": { "defaultValue": "*", "field": "id" },
      "search": {
        "type": "inline",
        "query": "${cribl_worker_groups} isFleet==true | summarize by id",
        "earliest": "$time_range.earliest$",
        "latest": "$time_range.latest$",
        "timezone": "$time_range.timezone$"
      },
      "layout": { "x": 3, "y": 0, "w": 3, "h": 2 }
    },
    {
      "id": "ht-worker-group-dropdown",
      "type": "input.dropdown",
      "variant": "input",
      "title": "Worker Group (Stream)",
      "inputId": "worker_group",
      "config": { "defaultValue": "*", "field": "id" },
      "search": {
        "type": "inline",
        "query": "${cribl_worker_groups} isFleet==false | summarize by id",
        "earliest": "$time_range.earliest$",
        "latest": "$time_range.latest$",
        "timezone": "$time_range.timezone$"
      },
      "layout": { "x": 6, "y": 0, "w": 3, "h": 2 }
    },
    {
      "id": "ht-markdown",
      "type": "markdown.default",
      "variant": "markdown",
      "config": {
        "markdown": "# Heavy Talkers\n\nView **Edge nodes** (by Fleet) and **Worker nodes** (by Worker group) with the highest throughput. Use the **Time Range** picker to set the window; use the **Fleet** dropdown to filter Edge heavy talkers and **Worker group** for Stream workers. Choose * for all. Tables show top nodes by outbound events (or last activity if metrics are not available).\n",
        "axis": {}
      },
      "layout": { "x": 0, "y": 2, "w": 12, "h": 2 }
    },
    {
      "id": "ht-edge-table",
      "type": "list.table",
      "title": "Edge nodes (heavy talkers)",
      "config": {},
      "search": {
        "type": "inline",
        "query": "${cribl_worker_metrics} (group==\"$fleet\" or \"$fleet\"==\"*\") | sort by coalesce(lastMetrics[\"total.out_events\"], outEvents, out_events, 0) desc, lastMsgTime desc | take 25 | project group, id, hostname=info.hostname, in_events=coalesce(lastMetrics[\"total.in_events\"], inEvents, in_events), out_events=coalesce(lastMetrics[\"total.out_events\"], outEvents, out_events), in_bytes=coalesce(lastMetrics[\"total.in_bytes\"], inBytes, in_bytes), out_bytes=coalesce(lastMetrics[\"total.out_bytes\"], outBytes, out_bytes), lastMsgTime, status",
        "earliest": "$time_range.earliest$",
        "latest": "$time_range.latest$",
        "timezone": "$time_range.timezone$"
      },
      "layout": { "x": 0, "y": 4, "w": 12, "h": 5 }
    },
    {
      "id": "ht-worker-table",
      "type": "list.table",
      "title": "Worker nodes (heavy talkers)",
      "config": {},
      "search": {
        "type": "inline",
        "query": "${cribl_worker_metrics} (group==\"$worker_group\" or \"$worker_group\"==\"*\") | sort by coalesce(lastMetrics[\"total.out_events\"], outEvents, out_events, 0) desc, lastMsgTime desc | take 25 | project group, id, hostname=info.hostname, in_events=coalesce(lastMetrics[\"total.in_events\"], inEvents, in_events), out_events=coalesce(lastMetrics[\"total.out_events\"], outEvents, out_events), in_bytes=coalesce(lastMetrics[\"total.in_bytes\"], inBytes, in_bytes), out_bytes=coalesce(lastMetrics[\"total.out_bytes\"], outBytes, out_bytes), lastMsgTime, status",
        "earliest": "$time_range.earliest$",
        "latest": "$time_range.latest$",
        "timezone": "$time_range.timezone$"
      },
      "layout": { "x": 0, "y": 9, "w": 12, "h": 5 }
    }
  ]
}
